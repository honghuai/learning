<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>通过组件组织过渡</title>
</head>
<body>
<div id="app">
    <input type="text" v-model.number="firstNum" type="number" step="20">+
    <input type="text" v-model.number="secondNum" type="number" step="20">=
    {{result}}
    <div>
        <animated-int :value="firstNum"></animated-int>+
        <animated-int :value="secondNum"></animated-int>=
        <animated-int :value="result"></animated-int>
    </div>
</div>
</body>
<script src="../../lib/vue2.1.3.js"></script>
<script src="https://unpkg.com/tween.js@16.3.4"></script>
<script>
    Vue.component("animated-int",{
        template: '<span>{{tweeningValue}}</span>',
        props: {
            value: {
                type: Number,
                required: true
            }
        },
        data: function() {
            return {
                tweeningValue: 0
            }
        },
        watch: {
            value: function(newV,oldV) {
                this.tween(oldV,newV);
            }
        },
        mounted: function() {
            this.tween(0,this.value);
        },
        methods: {
            tween: function(startV,endV) {
                var vm = this;
                function animate(time) {
                    requestAnimationFrame(animate);
                    TWEEN.update(time);
                }
                new TWEEN.Tween({
                    tweeningValue: startV
                }).to({
                    tweeningValue: endV
                },500).onUpdate(function() {
                            vm.tweeningValue = this.tweeningValue.toFixed(0);
                        })
                        .start();
                animate();
            }
        }
    })
    var vm = new Vue({
        el: "#app",
        data: {
            firstNum: 20,
            secondNum: 40
        },
        computed: {
            result: function() {
                return this.firstNum + this.secondNum
            }
        }
    })
</script>
</html>